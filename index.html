<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Bilderrätsel</title>

<style>
body {
  margin: 0;
  background: #111;
  color: #fff;
  font-family: Arial, sans-serif;
  text-align: center;
}

h1 {
  margin: 10px 0;
}

#bild {
  max-width: 90%;
  max-height: 70vh;
  margin-top: 10px;
}

#loesung {
  display: none;
  font-size: 2em;
  margin-top: 15px;
  color: #00ffcc;
}

button {
  font-size: 1.1em;
  padding: 10px 18px;
  margin: 6px;
  cursor: pointer;
}

#topbar {
  margin-bottom: 10px;
}
</style>
</head>

<body>

<h1>Bilderrätsel</h1>

<div id="topbar">
  <input type="file" id="bilderInput" multiple accept="image/*">
  <button onclick="fullscreen()">Fullscreen</button>
</div>

<img id="bild">
<div id="loesung"></div>

<div>
  <button onclick="zurueck()">← Zurück</button>
  <button onclick="weiter()">Weiter →</button>
</div>

<script>
let bilder = [];
let index = 0;
let loesungSichtbar = false;

// Bilder laden (Firefox-sicher)
document.getElementById("bilderInput").addEventListener("change", e => {
  bilder = [];

  for (const file of e.target.files) {
    if (file.type.startsWith("image")) {
      const name = file.name.replace(/\.[^/.]+$/, "").replace(/[_-]/g, " ");
      bilder.push({
        src: URL.createObjectURL(file),
        loesung: name
      });
    }
  }

  if (bilder.length === 0) {
    alert("Keine Bilder geladen.");
    return;
  }

  shuffle(bilder);
  index = 0;
  anzeigen();
});

// Zufällige Reihenfolge (Fisher–Yates)
function shuffle(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
}

function anzeigen() {
  document.getElementById("bild").src = bilder[index].src;
  const l = document.getElementById("loesung");
  l.innerText = bilder[index].loesung;
  l.style.display = "none";
  loesungSichtbar = false;
}

function weiter() {
  if (!bilder.length) return;

  if (!loesungSichtbar) {
    document.getElementById("loesung").style.display = "block";
    loesungSichtbar = true;
  } else if (index < bilder.length - 1) {
    index++;
    anzeigen();
  }
}

function zurueck() {
  if (index > 0) {
    index--;
    anzeigen();
  }
}

function fullscreen() {
  document.documentElement.requestFullscreen();
}

// Tastatursteuerung
document.addEventListener("keydown", e => {
  if (e.key === "ArrowRight" || e.key === " ") weiter();
  if (e.key === "ArrowLeft") zurueck();
});
</script>

</body>
</html>
